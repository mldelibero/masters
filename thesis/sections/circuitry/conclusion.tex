\subsection{Circuity Capabilities}

Under most operating conditions, the circuit described in Section: \ref{sec:measCirc} can measure the \gls{dut}'s magnitude and phase with a theoretical error of less than $1\%$. This section will describe the operating conditons which lead to a larger measurement error. The OPA365 operational amplifier in Section: \ref{sec:iMeas} has an input offset voltage of $200\mu V$. This causes about a $4\%$ error in the impedance measurement at the low end of each current measurement range (Table: \ref{table:imeas_table}). This error drops to less than $1\%$ by the time the current increases by half of an order of magnitude.  The OPA365 also has an input offset current of $10pA$. This results in a maximum error of $1\%$ when measuring a current of $1nA$. These error sources combine for a worst case erorr of $5\%$.

The filtering circuitry described in Section: \ref{sec:filtering} introduces an additional error. In this implementation, the OPA365's input offset voltage voltage is multiplied by 3 to introduce a $600\mu V$ offset error. This equates to a $12\%$ error at the low end of each current range and a $1.2\%$ error at an order of magnitude above that. The main affect of this error is to reduce the maximum current that can be measured in each range. The circuit can be calibrated in software to remove the offset error from the final result so that it does not appreciably affect the measurement for most of the range.

The AD8392 circuit described in Section: \ref{sec:mag} introduces a frequency dependent error (if left uncompensated). An impedance analysis $10\mu F$ capacitor with a $100mV$ excitation voltage results in a maximum magnitude error of $10\%$ at 500Hz. This is due to the fact that the AD8392 has an error that increases with the input gain. 500Hz is the first frequency in this scenario that requires the high gain stage of the current measurement. The phase error for the AD8392 is always less than $1\%$ when the capacitor is not near the resonance point.

